-- Criação do banco de dados
DROP DATABASE IF EXISTS `combustivel_aop2`;
CREATE DATABASE `combustivel_aop2` 
DEFAULT CHARACTER SET utf8mb4 COLLATE utf8mb4_0900_ai_ci;
USE `combustivel_aop2`;

-- Tabela de tipos de combustível
CREATE TABLE `combustiveis` (
  `id` int NOT NULL AUTO_INCREMENT,
  `tipo` varchar(50) NOT NULL,
  PRIMARY KEY (`id`)
) ENGINE=InnoDB AUTO_INCREMENT=1 DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_0900_ai_ci;

-- Inserção dos tipos de combustível
INSERT INTO `combustiveis` (`tipo`) VALUES 
('Gasolina'),
('Etanol'),
('Diesel'),
('Gasolina Aditivada');

-- Tabela de postos
CREATE TABLE `postos` (
  `id` int NOT NULL AUTO_INCREMENT,
  `nomeid` varchar(100) NOT NULL,
  `endereco` varchar(200) NOT NULL,
  PRIMARY KEY (`id`)
) ENGINE=InnoDB AUTO_INCREMENT=1 DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_0900_ai_ci;

-- Inserção dos postos
INSERT INTO `postos` (`nomeid`, `endereco`) VALUES 
('Posto Petrobas', 'Av. Nair Azevedo Silva, 1 76 - Ilha do Príncipe'),
('Posto Auto Posto', 'Rod - Av. Carlos Lindenberg, 101'),
('Posto Valentim', 'BR-262 - Vila Capixaba'),
('Posto Ipiranga', 'Av. Nair Azevedo Silva, 430 - Ilha do Príncipe'),
('Posto Shell', 'Av. Leitão da Silva, 420 - Praia do Suá'),
('Posto Ataide', 'Rua São Joao, 50 - Ataide');

-- Tabela de preços
CREATE TABLE `precos_combustivel` (
  `id` int NOT NULL AUTO_INCREMENT,
  `id_posto` int DEFAULT NULL,
  `id_combustivel` int DEFAULT NULL,
  `preco` decimal(5,2) NOT NULL,
  `data_atualizacao` date DEFAULT NULL,
  PRIMARY KEY (`id`),
  KEY `id_posto` (`id_posto`),
  KEY `id_combustivel` (`id_combustivel`),
  CONSTRAINT `precos_combustivel_ibfk_1` FOREIGN KEY (`id_posto`) REFERENCES `postos` (`id`),
  CONSTRAINT `precos_combustivel_ibfk_2` FOREIGN KEY (`id_combustivel`) REFERENCES `combustiveis` (`id`)
) ENGINE=InnoDB AUTO_INCREMENT=1 DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_0900_ai_ci;

-- Inserção dos preços com NOVAS DATAS (14-23/03/2025)
-- Posto 1 (Petrobas)
INSERT INTO `precos_combustivel` (`id_posto`, `id_combustivel`, `preco`, `data_atualizacao`) VALUES
(1, 1, 5.60, '2025-03-14'), (1, 1, 5.61, '2025-03-15'), (1, 1, 5.62, '2025-03-16'),
(1, 1, 5.63, '2025-03-17'), (1, 1, 5.64, '2025-03-18'), (1, 1, 5.65, '2025-03-19'),
(1, 1, 5.66, '2025-03-20'), (1, 1, 5.67, '2025-03-21'), (1, 1, 5.68, '2025-03-22'),
(1, 1, 5.69, '2025-03-23'),

(1, 2, 4.50, '2025-03-14'), (1, 2, 4.51, '2025-03-15'), (1, 2, 4.52, '2025-03-16'),
(1, 2, 4.53, '2025-03-17'), (1, 2, 4.54, '2025-03-18'), (1, 2, 4.55, '2025-03-19'),
(1, 2, 4.56, '2025-03-20'), (1, 2, 4.57, '2025-03-21'), (1, 2, 4.58, '2025-03-22'),
(1, 2, 4.59, '2025-03-23'),

(1, 3, 6.20, '2025-03-14'), (1, 3, 6.21, '2025-03-15'), (1, 3, 6.22, '2025-03-16'),
(1, 3, 6.23, '2025-03-17'), (1, 3, 6.24, '2025-03-18'), (1, 3, 6.25, '2025-03-19'),
(1, 3, 6.26, '2025-03-20'), (1, 3, 6.27, '2025-03-21'), (1, 3, 6.28, '2025-03-22'),
(1, 3, 6.29, '2025-03-23'),

(1, 4, 3.90, '2025-03-14'), (1, 4, 3.91, '2025-03-15'), (1, 4, 3.92, '2025-03-16'),
(1, 4, 3.93, '2025-03-17'), (1, 4, 3.94, '2025-03-18'), (1, 4, 3.95, '2025-03-19'),
(1, 4, 3.96, '2025-03-20'), (1, 4, 3.97, '2025-03-21'), (1, 4, 3.98, '2025-03-22'),
(1, 4, 3.99, '2025-03-23'),

-- Posto 2 (Auto Posto)
(2, 1, 5.70, '2025-03-14'), (2, 1, 5.71, '2025-03-15'), (2, 1, 5.72, '2025-03-16'),
(2, 1, 5.73, '2025-03-17'), (2, 1, 5.74, '2025-03-18'), (2, 1, 5.75, '2025-03-19'),
(2, 1, 5.76, '2025-03-20'), (2, 1, 5.77, '2025-03-21'), (2, 1, 5.78, '2025-03-22'),
(2, 1, 5.79, '2025-03-23'),

(2, 2, 4.60, '2025-03-14'), (2, 2, 4.61, '2025-03-15'), (2, 2, 4.62, '2025-03-16'),
(2, 2, 4.63, '2025-03-17'), (2, 2, 4.64, '2025-03-18'), (2, 2, 4.65, '2025-03-19'),
(2, 2, 4.66, '2025-03-20'), (2, 2, 4.67, '2025-03-21'), (2, 2, 4.68, '2025-03-22'),
(2, 2, 4.69, '2025-03-23'),

(2, 3, 6.30, '2025-03-14'), (2, 3, 6.31, '2025-03-15'), (2, 3, 6.32, '2025-03-16'),
(2, 3, 6.33, '2025-03-17'), (2, 3, 6.34, '2025-03-18'), (2, 3, 6.35, '2025-03-19'),
(2, 3, 6.36, '2025-03-20'), (2, 3, 6.37, '2025-03-21'), (2, 3, 6.38, '2025-03-22'),
(2, 3, 6.39, '2025-03-23'),

(2, 4, 4.00, '2025-03-14'), (2, 4, 4.01, '2025-03-15'), (2, 4, 4.02, '2025-03-16'),
(2, 4, 4.03, '2025-03-17'), (2, 4, 4.04, '2025-03-18'), (2, 4, 4.05, '2025-03-19'),
(2, 4, 4.06, '2025-03-20'), (2, 4, 4.07, '2025-03-21'), (2, 4, 4.08, '2025-03-22'),
(2, 4, 4.09, '2025-03-23'),

-- Posto 3 (Valentim)
(3, 1, 5.80, '2025-03-14'), (3, 1, 5.81, '2025-03-15'), (3, 1, 5.82, '2025-03-16'),
(3, 1, 5.83, '2025-03-17'), (3, 1, 5.84, '2025-03-18'), (3, 1, 5.85, '2025-03-19'),
(3, 1, 5.86, '2025-03-20'), (3, 1, 5.87, '2025-03-21'), (3, 1, 5.88, '2025-03-22'),
(3, 1, 5.89, '2025-03-23'),

(3, 2, 4.70, '2025-03-14'), (3, 2, 4.71, '2025-03-15'), (3, 2, 4.72, '2025-03-16'),
(3, 2, 4.73, '2025-03-17'), (3, 2, 4.74, '2025-03-18'), (3, 2, 4.75, '2025-03-19'),
(3, 2, 4.76, '2025-03-20'), (3, 2, 4.77, '2025-03-21'), (3, 2, 4.78, '2025-03-22'),
(3, 2, 4.79, '2025-03-23'),

(3, 3, 6.40, '2025-03-14'), (3, 3, 6.41, '2025-03-15'), (3, 3, 6.42, '2025-03-16'),
(3, 3, 6.43, '2025-03-17'), (3, 3, 6.44, '2025-03-18'), (3, 3, 6.45, '2025-03-19'),
(3, 3, 6.46, '2025-03-20'), (3, 3, 6.47, '2025-03-21'), (3, 3, 6.48, '2025-03-22'),
(3, 3, 6.49, '2025-03-23'),

(3, 4, 4.10, '2025-03-14'), (3, 4, 4.11, '2025-03-15'), (3, 4, 4.12, '2025-03-16'),
(3, 4, 4.13, '2025-03-17'), (3, 4, 4.14, '2025-03-18'), (3, 4, 4.15, '2025-03-19'),
(3, 4, 4.16, '2025-03-20'), (3, 4, 4.17, '2025-03-21'), (3, 4, 4.18, '2025-03-22'),
(3, 4, 4.19, '2025-03-23'),

-- Posto 4 (Ipiranga)
(4, 1, 5.90, '2025-03-14'), (4, 1, 5.91, '2025-03-15'), (4, 1, 5.92, '2025-03-16'),
(4, 1, 5.93, '2025-03-17'), (4, 1, 5.94, '2025-03-18'), (4, 1, 5.95, '2025-03-19'),
(4, 1, 5.96, '2025-03-20'), (4, 1, 5.97, '2025-03-21'), (4, 1, 5.98, '2025-03-22'),
(4, 1, 5.99, '2025-03-23'),

(4, 2, 4.80, '2025-03-14'), (4, 2, 4.81, '2025-03-15'), (4, 2, 4.82, '2025-03-16'),
(4, 2, 4.83, '2025-03-17'), (4, 2, 4.84, '2025-03-18'), (4, 2, 4.85, '2025-03-19'),
(4, 2, 4.86, '2025-03-20'), (4, 2, 4.87, '2025-03-21'), (4, 2, 4.88, '2025-03-22'),
(4, 2, 4.89, '2025-03-23'),

(4, 3, 6.50, '2025-03-14'), (4, 3, 6.51, '2025-03-15'), (4, 3, 6.52, '2025-03-16'),
(4, 3, 6.53, '2025-03-17'), (4, 3, 6.54, '2025-03-18'), (4, 3, 6.55, '2025-03-19'),
(4, 3, 6.56, '2025-03-20'), (4, 3, 6.57, '2025-03-21'), (4, 3, 6.58, '2025-03-22'),
(4, 3, 6.59, '2025-03-23'),

(4, 4, 4.20, '2025-03-14'), (4, 4, 4.21, '2025-03-15'), (4, 4, 4.22, '2025-03-16'),
(4, 4, 4.23, '2025-03-17'), (4, 4, 4.24, '2025-03-18'), (4, 4, 4.25, '2025-03-19'),
(4, 4, 4.26, '2025-03-20'), (4, 4, 4.27, '2025-03-21'), (4, 4, 4.28, '2025-03-22'),
(4, 4, 4.29, '2025-03-23'),

-- Posto 5 (Shell)
(5, 1, 6.00, '2025-03-14'), (5, 1, 6.01, '2025-03-15'), (5, 1, 6.02, '2025-03-16'),
(5, 1, 6.03, '2025-03-17'), (5, 1, 6.04, '2025-03-18'), (5, 1, 6.05, '2025-03-19'),
(5, 1, 6.06, '2025-03-20'), (5, 1, 6.07, '2025-03-21'), (5, 1, 6.08, '2025-03-22'),
(5, 1, 6.09, '2025-03-23'),

(5, 2, 4.90, '2025-03-14'), (5, 2, 4.91, '2025-03-15'), (5, 2, 4.92, '2025-03-16'),
(5, 2, 4.93, '2025-03-17'),(5, 2, 4.94, '2025-03-18'), (5, 2, 4.95, '2025-03-19'), (5, 2, 4.96, '2025-03-20'),
(5, 2, 4.97, '2025-03-21'), (5, 2, 4.98, '2025-03-22'), (5, 2, 4.99, '2025-03-23'),

(5, 3, 6.60, '2025-03-14'), (5, 3, 6.61, '2025-03-15'), (5, 3, 6.62, '2025-03-16'),
(5, 3, 6.63, '2025-03-17'), (5, 3, 6.64, '2025-03-18'), (5, 3, 6.65, '2025-03-19'),
(5, 3, 6.66, '2025-03-20'), (5, 3, 6.67, '2025-03-21'), (5, 3, 6.68, '2025-03-22'),
(5, 3, 6.69, '2025-03-23'),

(5, 4, 4.30, '2025-03-14'), (5, 4, 4.31, '2025-03-15'), (5, 4, 4.32, '2025-03-16'),
(5, 4, 4.33, '2025-03-17'), (5, 4, 4.34, '2025-03-18'), (5, 4, 4.35, '2025-03-19'),
(5, 4, 4.36, '2025-03-20'), (5, 4, 4.37, '2025-03-21'), (5, 4, 4.38, '2025-03-22'),
(5, 4, 4.39, '2025-03-23'),

-- Posto 6 (Ataide)
(6, 1, 6.10, '2025-03-14'), (6, 1, 6.11, '2025-03-15'), (6, 1, 6.12, '2025-03-16'),
(6, 1, 6.13, '2025-03-17'), (6, 1, 6.14, '2025-03-18'), (6, 1, 6.15, '2025-03-19'),
(6, 1, 6.16, '2025-03-20'), (6, 1, 6.17, '2025-03-21'), (6, 1, 6.18, '2025-03-22'),
(6, 1, 6.19, '2025-03-23'),

(6, 2, 5.00, '2025-03-14'), (6, 2, 5.01, '2025-03-15'), (6, 2, 5.02, '2025-03-16'),
(6, 2, 5.03, '2025-03-17'), (6, 2, 5.04, '2025-03-18'), (6, 2, 5.05, '2025-03-19'),
(6, 2, 5.06, '2025-03-20'), (6, 2, 5.07, '2025-03-21'), (6, 2, 5.08, '2025-03-22'),
(6, 2, 5.09, '2025-03-23'),

(6, 3, 6.70, '2025-03-14'), (6, 3, 6.71, '2025-03-15'), (6, 3, 6.72, '2025-03-16'),
(6, 3, 6.73, '2025-03-17'), (6, 3, 6.74, '2025-03-18'), (6, 3, 6.75, '2025-03-19'),
(6, 3, 6.76, '2025-03-20'), (6, 3, 6.77, '2025-03-21'), (6, 3, 6.78, '2025-03-22'),
(6, 3, 6.79, '2025-03-23'),

(6, 4, 4.40, '2025-03-14'), (6, 4, 4.41, '2025-03-15'), (6, 4, 4.42, '2025-03-16'),
(6, 4, 4.43, '2025-03-17'), (6, 4, 4.44, '2025-03-18'), (6, 4, 4.45, '2025-03-19'),
(6, 4, 4.46, '2025-03-20'), (6, 4, 4.47, '2025-03-21'), (6, 4, 4.48, '2025-03-22'),
(6, 4, 4.49, '2025-03-23');

-- Consulta para verificar os preços atualizados (+R$1,00) e novas datas
SELECT 
    p.nomeid AS Posto,
    c.tipo AS Combustível,
    pc.preco AS 'Preço Atualizado',
    pc.data_atualizacao AS 'Data Nova',
    (pc.preco - 1.00) AS 'Preço Original',
    DATE_SUB(pc.data_atualizacao, INTERVAL 188 DAY) AS 'Data Original'
FROM 
    precos_combustivel pc
JOIN 
    postos p ON pc.id_posto = p.id
JOIN 
    combustiveis c ON pc.id_combustivel = c.id
ORDER BY 
    pc.data_atualizacao, 
    p.nomeid, 
    c.tipo
LIMIT 40;
    